"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.makeAssetHandler = makeAssetHandler;
exports.destinationToClientOptions = destinationToClientOptions;
const container_images_1 = require("./container-images");
const files_1 = require("./files");
const asset_manifest_1 = require("../../asset-manifest");
function makeAssetHandler(manifest, asset, host, options) {
    if (asset instanceof asset_manifest_1.FileManifestEntry) {
        return new files_1.FileAssetHandler(manifest.directory, asset, host);
    }
    if (asset instanceof asset_manifest_1.DockerImageManifestEntry) {
        return new container_images_1.ContainerImageAssetHandler(manifest.directory, asset, host, options);
    }
    throw new Error(`Unrecognized asset type: '${asset}'`);
}
function destinationToClientOptions(destination) {
    // Explicitly build ClientOptions from AwsDestination. The fact they are structurally compatible is coincidental.
    // This also enforces better type checking that cdk-assets depends on the appropriate version of
    // @aws-cdk/cloud-assembly-schema.
    return {
        assumeRoleArn: destination.assumeRoleArn,
        assumeRoleExternalId: destination.assumeRoleExternalId,
        assumeRoleAdditionalOptions: destination.assumeRoleAdditionalOptions,
        region: destination.region,
    };
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW5kZXguanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyJpbmRleC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOztBQVlBLDRDQWNDO0FBRUQsZ0VBVUM7QUFyQ0QseURBQWdFO0FBQ2hFLG1DQUEyQztBQUMzQyx5REFLOEI7QUFJOUIsU0FBZ0IsZ0JBQWdCLENBQzlCLFFBQXVCLEVBQ3ZCLEtBQXFCLEVBQ3JCLElBQWtCLEVBQ2xCLE9BQXdCO0lBRXhCLElBQUksS0FBSyxZQUFZLGtDQUFpQixFQUFFLENBQUM7UUFDdkMsT0FBTyxJQUFJLHdCQUFnQixDQUFDLFFBQVEsQ0FBQyxTQUFTLEVBQUUsS0FBSyxFQUFFLElBQUksQ0FBQyxDQUFDO0lBQy9ELENBQUM7SUFDRCxJQUFJLEtBQUssWUFBWSx5Q0FBd0IsRUFBRSxDQUFDO1FBQzlDLE9BQU8sSUFBSSw2Q0FBMEIsQ0FBQyxRQUFRLENBQUMsU0FBUyxFQUFFLEtBQUssRUFBRSxJQUFJLEVBQUUsT0FBTyxDQUFDLENBQUM7SUFDbEYsQ0FBQztJQUVELE1BQU0sSUFBSSxLQUFLLENBQUMsNkJBQTZCLEtBQUssR0FBRyxDQUFDLENBQUM7QUFDekQsQ0FBQztBQUVELFNBQWdCLDBCQUEwQixDQUFDLFdBQTJCO0lBQ3BFLGlIQUFpSDtJQUNqSCxnR0FBZ0c7SUFDaEcsa0NBQWtDO0lBQ2xDLE9BQU87UUFDTCxhQUFhLEVBQUUsV0FBVyxDQUFDLGFBQWE7UUFDeEMsb0JBQW9CLEVBQUUsV0FBVyxDQUFDLG9CQUFvQjtRQUN0RCwyQkFBMkIsRUFBRSxXQUFXLENBQUMsMkJBQTJCO1FBQ3BFLE1BQU0sRUFBRSxXQUFXLENBQUMsTUFBTTtLQUMzQixDQUFDO0FBQ0osQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEF3c0Rlc3RpbmF0aW9uIH0gZnJvbSAnQGF3cy1jZGsvY2xvdWQtYXNzZW1ibHktc2NoZW1hJztcbmltcG9ydCB7IENvbnRhaW5lckltYWdlQXNzZXRIYW5kbGVyIH0gZnJvbSAnLi9jb250YWluZXItaW1hZ2VzJztcbmltcG9ydCB7IEZpbGVBc3NldEhhbmRsZXIgfSBmcm9tICcuL2ZpbGVzJztcbmltcG9ydCB7XG4gIEFzc2V0TWFuaWZlc3QsXG4gIERvY2tlckltYWdlTWFuaWZlc3RFbnRyeSxcbiAgRmlsZU1hbmlmZXN0RW50cnksXG4gIElNYW5pZmVzdEVudHJ5LFxufSBmcm9tICcuLi8uLi9hc3NldC1tYW5pZmVzdCc7XG5pbXBvcnQgdHlwZSB7IENsaWVudE9wdGlvbnMgfSBmcm9tICcuLi8uLi9hd3MnO1xuaW1wb3J0IHsgSUFzc2V0SGFuZGxlciwgSUhhbmRsZXJIb3N0LCBJSGFuZGxlck9wdGlvbnMgfSBmcm9tICcuLi9hc3NldC1oYW5kbGVyJztcblxuZXhwb3J0IGZ1bmN0aW9uIG1ha2VBc3NldEhhbmRsZXIoXG4gIG1hbmlmZXN0OiBBc3NldE1hbmlmZXN0LFxuICBhc3NldDogSU1hbmlmZXN0RW50cnksXG4gIGhvc3Q6IElIYW5kbGVySG9zdCxcbiAgb3B0aW9uczogSUhhbmRsZXJPcHRpb25zXG4pOiBJQXNzZXRIYW5kbGVyIHtcbiAgaWYgKGFzc2V0IGluc3RhbmNlb2YgRmlsZU1hbmlmZXN0RW50cnkpIHtcbiAgICByZXR1cm4gbmV3IEZpbGVBc3NldEhhbmRsZXIobWFuaWZlc3QuZGlyZWN0b3J5LCBhc3NldCwgaG9zdCk7XG4gIH1cbiAgaWYgKGFzc2V0IGluc3RhbmNlb2YgRG9ja2VySW1hZ2VNYW5pZmVzdEVudHJ5KSB7XG4gICAgcmV0dXJuIG5ldyBDb250YWluZXJJbWFnZUFzc2V0SGFuZGxlcihtYW5pZmVzdC5kaXJlY3RvcnksIGFzc2V0LCBob3N0LCBvcHRpb25zKTtcbiAgfVxuXG4gIHRocm93IG5ldyBFcnJvcihgVW5yZWNvZ25pemVkIGFzc2V0IHR5cGU6ICcke2Fzc2V0fSdgKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGRlc3RpbmF0aW9uVG9DbGllbnRPcHRpb25zKGRlc3RpbmF0aW9uOiBBd3NEZXN0aW5hdGlvbik6IENsaWVudE9wdGlvbnMge1xuICAvLyBFeHBsaWNpdGx5IGJ1aWxkIENsaWVudE9wdGlvbnMgZnJvbSBBd3NEZXN0aW5hdGlvbi4gVGhlIGZhY3QgdGhleSBhcmUgc3RydWN0dXJhbGx5IGNvbXBhdGlibGUgaXMgY29pbmNpZGVudGFsLlxuICAvLyBUaGlzIGFsc28gZW5mb3JjZXMgYmV0dGVyIHR5cGUgY2hlY2tpbmcgdGhhdCBjZGstYXNzZXRzIGRlcGVuZHMgb24gdGhlIGFwcHJvcHJpYXRlIHZlcnNpb24gb2ZcbiAgLy8gQGF3cy1jZGsvY2xvdWQtYXNzZW1ibHktc2NoZW1hLlxuICByZXR1cm4ge1xuICAgIGFzc3VtZVJvbGVBcm46IGRlc3RpbmF0aW9uLmFzc3VtZVJvbGVBcm4sXG4gICAgYXNzdW1lUm9sZUV4dGVybmFsSWQ6IGRlc3RpbmF0aW9uLmFzc3VtZVJvbGVFeHRlcm5hbElkLFxuICAgIGFzc3VtZVJvbGVBZGRpdGlvbmFsT3B0aW9uczogZGVzdGluYXRpb24uYXNzdW1lUm9sZUFkZGl0aW9uYWxPcHRpb25zLFxuICAgIHJlZ2lvbjogZGVzdGluYXRpb24ucmVnaW9uLFxuICB9O1xufVxuIl19